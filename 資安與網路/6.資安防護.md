# 閱讀筆記 > 資安與網路 > 6.資安防護

> References 
> - Module 18. Understanding Defense. CyberOps Associate Training from Cisco Networking Academy.
> - Module 19. Access Control. CyberOps Associate Training from Cisco Networking Academy.
> - Module 20. Threat Intelligence. CyberOps Associate Training from Cisco Networking Academy.
> - Module 21. Cryptography. CyberOps Associate Training from Cisco Networking Academy.
> - Module 22. Endpoint Protection. CyberOps Associate Training from Cisco Networking Academy.
> - Module 23. Endpoint Vulnerability Assesment. CyberOps Associate Training from Cisco Networking Academy.

## 6-1. 縱深防禦
- 辨別資產、漏洞、威脅
    - 資產(assets)：盤點資產、發展並施以保護措施，辨識並規範如何使用重要資訊資產(critical information assets)。資產構成攻擊面。
    - 漏洞(vulnerabilities)：評估時要注意系統本身弱點(常用的軟硬韌體、重要的服務項目)、資訊資產存取者範圍(內部、外部)、不當存取後果(錯誤資料輸入)。
    - 威脅(threats)：以縱深防禦思考，包括最外層的邊緣伺服器(edge router)、第二層防火牆、IPS、AMP、網頁或電郵防護系統、第三層內網閘道伺服器(internal router)。
    
- 縱深防禦類比
    - 不同層防禦的功能可互補，單層失效不影響其他層。

    | 模型 | Security Onion | Security Artichoke |
    | --- | --- | --- |
    | 結構方式 | 層層防禦，實體/網路安全架構部署 | 葉片式防禦 ，威脅獵捕、數位鑑識、攻擊溯源 |
    | 防禦邏輯 | 必須逐層突破 | 可選擇性突破 |
    | 適用場景 | 傳統企業網路，防火牆、WAF、SIEM、EDR 等 | 雲端、行動、零信任架構，Splunk、Elastic、Threat Intel 平台等 |
    | 風險點 | 對新型態網路不夠靈活 | 單一葉片失守可能導致滲透 |
    - Security Onion不同於資安工具Security Onion suite。


> 常用字彙集

| 華語 | ENG |
| --- | --- |
| 行動裝置被入侵/遭到攻破 | compromise a mobile device |
| 駭客逐漸削弱企業週邊的安全防禦，直達企業的「心臟」。 | The hacker chips away at the security armor along the perimeter to get to the “heart” of the enterprise. |
| 相似於剝皮洋蔥 | in a manner similar to peeling an onion |
| 逐層剝皮網路防禦 | peel away at a network’s defenses layer by layer |
| 建立安全架構 | create a security architecture |
| 授予外部遠端使用者存取內部網路資源的權限 | grant external remote users access to internal network resources |
| 邊緣路由器有一組規則指定允許或拒絕哪些流量。 | The edge router has a set of rules specifying which traffic it allows or denies. |
| 掃描流量 | screen the traffic |
| 在網路邊緣、網路內部以及網路端點 | at the network edge, within the network, and on network endpoints |
| 採用縱深防禦方式 | use a defense-in-depth approach |
| 災難性事件 | cataclysmic event |
| 運用系統漏洞 | system vulnerabilities are exploited |
| 遺失資產 | assets are lost | 
| 盤點資產 | inventory the assets |
| 評估資產 | assess the assets |
| 構成攻擊面 | constitute the attack surface |
| 阻止潛在的攻擊 | thwart potential attacks |
| 資產構成攻擊面 | The assets constitute the attack surface |
| 雲端和虛擬服務 | cloud-based and virtual services |
| 新的裝置一直加入我們的網路 | new devices are joining our networks |


## 6-2. 資安政策與規範
- 經營政策(Business Policies)
    - 公司政策(company policies)
    - 員工政策(employee policies)：人資部
    - 安全政策(security policies)
        | 英文  | 中文翻譯      | 說明      |
        | --- | --- | --- |
        | **Identification and authentication policy** | 身份識別與驗證政策 | 指定哪些授權人員可以存取網路資源，以及身分驗證的程序。 |
        | **Password policies**  | 密碼政策 | 確保密碼符合最低要求，並需定期更換。 |
        | **Acceptable/appropriate Use Policy (AUP)** | 可接受使用政策 | 說明哪些網路應用與使用方式是組織允許的，並列出違反政策的後果。 |
        | **Remote access policy** | 遠端存取政策 | 定義遠端使用者如何存取網路，以及遠端連線可使用的資源範圍。 |
        | **Network maintenance policy**  | 網路維護政策 | 規範網路設備作業系統與使用者應用程式的更新程序。 |
        | **Incident handling procedures** | 事件處理程序 | 描述安全事件發生時的處理方式。 |
- BYOD政策
    - 減緩漏洞的對策：密碼設定、無線網路連線、保持系統更新、備份資料、啟用裝置定位服務(Find my Device, remote wipe feature)、提供防毒軟體、使用MDM軟體(Mobile Device Management software)。
- 外部法規
    - Information Systems Security (INFOSEC) professionals
    - security compliance regulations：定義組織需要負責哪些安全措施，若未遵守將承擔哪些法律責任。

> 常用字彙集

| 華語 | ENG |
| --- | --- |
| 訂閱設備定位器 | subscribe to a device locator |
| 失效 | the failure of |
| 隨著沒有邊界的網路發展演變，\ | With the evolution of borderless networks, |
| 對...是可接受的 | is acceptable to ... |
| 處理疑慮 | address the concerns |
| 在...提供彈性 | provide flexibility in |
| 遵守政府規範 | comply with governmental regulations |
| 起始點 | starting point |
| 有義務遵守法規 | is obligated to the compliance regulations |
| 負責制定和實施安全政策 | are mandated to develop and implement security policies |
| 確定設備受到威脅時應採取的保護措施。 | Identify safeguards to put in place if a device is compromised. |
| 確定必須遵守哪些規定 | Identify which regulations must be adhered to |
| BYOD為企業提供多項關鍵優勢 | BYOD provides several key benefits to enterprises |
| 簽署的AUP應在僱用期間保留 | the signed AUPs should be retained for the duration of employment |
| 應該要求簽署AUP | should be required to sign an AUP |
| 為安保人員提供管理層的支持 | gives security staff the backing of management |
| 確保系統操作的一致性 | ensures consistency in system operations |
| 設定預期行為的規則 | sets the rules for expected behavior |
| 展現組織對安全的承諾 | demonstrates an organization’s commitment to security |
| 政策規定... | policies define ... |
| 設定可用的基準線 | sets a baseline of acceptable use |


## 6-3. 存取控制
- 通訊安全-CIA三要素(CIA Triad)：機密性(Confidentiality)、完整性(Integrity)、可用性(Availability)。

- 零信任安全(zero trust security)：原則是"never trust, always verify"。傳統只區分inside/trusted和outside/untrusted，零信任是任何需要access control decision都視為邊緣，它的三大支柱是workforce/people、workloads/applications、workplace/devices。

- 存取控制模型(Access Control Models)：目的是避免privilege escalation。
    - 自主存取控制(DAC, Discretionary Access Control)：「最少限制」的模型(as-needec approach)，使用者作為資料擁有者可自行決定誰能存取。可用ACL或其他方法指定哪些使用者/群組能存取資訊。
    - 強制存取控制(MAC, Mandatory Access Control)：「最嚴格」的存取控制，用於軍事或高敏感環境。依照安全等級標籤分配資訊存取權限，使用者的存取權限依其安全等級決定。
    - 角色基礎存取控制(RBAC, Role-Based Access Control) / 非自主存取控制(non-discretionary access control)：存取決策依各角色被分配安全權限，個人被指定到某個角色即可取得相應權限。角色對應不同職位、職務分類或群組。
    - 屬性基礎存取控制(ABAC, Attribute-Based Access Control)：存取依照「物件屬性(資源) object」、「主體屬性(使用者) subject」及「環境因素(時間、地點、操作情境等)」決定。
    - 規則基礎存取控制(RBAC, Rule-Based Access Control, Rule Based RBAC)：安全人員設定一系列允許/拒絕規則條件，控制對資料/系統的存取。
    - 時間基礎存取控制(TAC, Time-Based Access Control)：根據時間與日期來允許存取網路資源。

- AAA協定
    - centralized AAA system：可獨立維護資料庫，利用AD或LDAP進行使用者驗證、群組身份驗證。
        - 與「AAA伺服器」溝通的通訊協定：Dial-In User Service (RADIUS) or Terminal Access Controller Access Control System (TACACS+) protocols。

    - Authentication：你是誰，如卡號和持卡人姓名
        - 通常用token。
        - local用於小型(分散式)。
        - server-based用於中大型網路(集中式，可擴充性高)。
    - Authorization：你可以做什麼，如信用卡額度

    - Accounting：你的動作紀錄，帳單明細
        - 常見的accounting資訊：network accounting (PPP sessions)、connection accounting (輸出連線)、EXEC accounting (EXEC終端session如user shells)、System Aaccounting、Command accounting、Resource accounting。

> 常用字彙集

| 華語 | ENG |
| --- | --- |
| 常用於軍事 | is commonly used in military |
| 加入更多網站伺服器用在負載平衡和替代路線 | add a couple more web servers for load balance and redundancy |
| 抓取所有session的訊息 | capture information for all sessions |
| 結束訊息被記錄 | stop message is recorded |
| 產生一個開始訊息 | generate a start message |
| 廣泛部署使用 | widely deployed use |
| 簡化使用者動作的稽核 | simplifY auditing of user actions. |
| 可擴充性且可管理的 | scalable and manageable  |
| 適合用在中大型網路 | is appropriate for medium-to-large networks. |
| 追蹤網路資源的使用情況 | keep track of how network resources are used |
| 強制實施會計制度 | mandate the implementation of an accounting system |
| 按需方法 | as-needed approach, On-Demand approach |
| 任意的、自主的 | discretionary |
| 最嚴格的存取控制 | the strictest access control |
| 最少限制的模型 | the least restrictive model |
| 實施合適存取控制 | implement proper access controls |
| 暖通空調系統、自助服務終端站、輸液幫浦 | HVAC systems, kiosks, infusion pumps |
| 個人或企業管控的裝置 | personal or corporate-managed devices |
| 攻擊者透過網路的橫向移動 | an attacker's lateral movement through a network |
| 零信任的三大支柱是人員、工作項和裝置種類。 | The three pillars of zero trust are workforce, workloads, and workplace. |
| 零信任安全框架 | zero trust security framework |
| 保護組織的員人員、工作項和裝置種類 | protects an organization’s workforce, workloads, and the workplace |
| 趨勢是朝著... | the trend is toward ... |
| 幾乎可以在任何有數據通訊的地方使用 | be used almost anywhere that there is data communication |
| 限制存取 | restrict access |
| 未經授權的存取、使用、揭露、破壞、異動、拆除 | unauthorized access, use, disclosure, disruption, modification, or destruction |


## 6-4. 威脅情資
- 網路智慧社群/組織(network intelligence communities / organization)
    - SANS Institue: Cybersecurity Training, Certifications, Internet Storm Center for Research & Resources.
    - Mitre Corperation: the exchange of
    - FIRST: global alliance, Collaboration, Information sharing, Rapid response.
    - SecurityNewsWire
    - (ISC)<sup>2</sup>: vendor-neutral training and certifications, career development
    - CIS: 24/7 cyber threat monitoring, warnings, and incident response
- 威脅情資服務(Threat Intelligence Services)
    - Cisco Talos：主要提供企業服務。共享情資、IOC、弱點。建立防火牆規則和IOC並將其分發到設備，並維護資安事件判斷規則到Snort.org、ClamAV、SpamCop。
    - FireEye：以Helix Security Platform提供SIEM、SOAR服務，屬於雲端託管安全營運平台。 
    - Automated Indicator Sharing (AIS)：由U.S. Department of Homeland Security (DHS)提供，美國政府與私人部門的資安訊息交換。
    - CVE (Common Vulnerabilities and Exposures)：由美國政府贊助的MITRE機構，維護資安弱點的CVE Identifiers，方便交換及分享情資。
- CTI情資共享與平台
    - 開源分享的標準格式：自動的、一致的、機器可讀的
        - Structured Threat Information Expression (STIX): 組織間交換情資。
            - Cyber Observable Expression (CybOX): 已併入STIX 2.0。抓取、分類、傳輸事件。
        - Trusted Automated Exchange of Indicator Information (TAXII): 讓CTI透過HTTPS傳輸。
    - 資料種類
        1. indicators of compromise (IOC)
        2. tools, techniques, procedures (TTP)
        3. reputation information about internet destinations or domains
    - 資料收集：蜜罐(Honeypot)(部署在雲端可降低風險)
    - 開源平台(threat intelligence platforms, TIP)
        - Malware Information Sharing Platform (MISP)：EU支援，自動共享IOC。
- 線上資源學習資源
    - [Cisco Cybersecurity Reports](https://www.cisco.com/site/us/en/products/security/cybersecurity-reports/index.html)
    - [Cisco Talos Intelligence Group](https://www.talosintelligence.com/)：部落格、播客。


> 常用字彙集

| 華語 | ENG |
| --- | --- |
| 威脅情報資料量可能非常龐大。 | The volume of threat intelligence data can be overwhelming. |
| 平台集中收集來自眾多資料來源和格式的威脅數據 | platform centralizes the collection of threat data from numerous data sources and formats |
| 實現跨多個網路平台的通訊 | enable communication across multiple networking platforms |
| 建立並維護目錄 | create and maintain a catalog |
| 能夠即時交換 | enable the real-time exchange |
| 解決網路攻擊生命週期的所有階段 | address all stages of an attack lifecycle |
| 雲端託管安全營運平台 | cloud-hosted security operations platform |
| 結合了... | .. combining ... |
| 採用三管齊下的方法 | uses a three-pronged approach |
| 維護規則集給... | maintains the rule sets for ... |
| 即時使用... | use ... in real time |
| 緩解技術 | mitigation techniques |
| 建立防火牆規則和IOC並將其分發到設備 | create and distribute firewall rules and IOCs to the devices |
| 隨著威脅升溫 | As threats emerge, |
| 允許交換威脅訊息 | allow the exchange of threat information |
| 尋找並下載報告 | locate and download report |
| 提供安全準備狀況的最新訊息 | provide an update on the state of security preparedness |
| 訂閱報告 | subscribe to reports  |
| 年報、半年報 | Annual Report, Mid-Year Report |
| 需要致力於... | requires a commitment to ... |
| 學習曲線非常陡峭 | has a very steep learning curve |
| 定期瀏覽與安全相關的網站 | routinely peruse security-related websites |
| 保持最新 | keep current with |
| 隨時了解最新威脅 | keep up-to-date on the latest threats |
| 隨時了解最新威脅 | Keep abreast of the latest threats |
| 隨時了解威脅和漏洞的演進 | stay informed about threats and vulnerabilities as they evolve |
| 焦點 | focal point |
| 威脅警告和建議 | threat warings and advisories |
| 屬於 | pertaining to |
| 促進資訊共享方面的合作與協調 | foster cooperation and coordination in information sharing |
| 根據要求 | upon request |
| 提供資源、研討會和會議 | provide resources, workshops, and conferences |


## 6-5. 密碼學(cryptography)
- 安全傳輸4大特性
    - 資料完整(data integrity)：資料傳輸時未被修改。
        - Secure Hash Algorithms (SHA-2 or SHA-3)
        - 不安全：MD5 
    - 來源驗證(origin authentication)：資料來源者非假冒。
        - hash-based message authentication code (HMAC)
    - 資料機密(data confidentiality)：資料取得者是經授權的人。
        - symmetric encryption algorithms
        - asymmetric encryption algorithms
    - 資料不可否認(data non-repudiation)：說明並追溯收發雙方的交易行為。
        - 寄送者的獨特特徵，如數位簽章。

- 加密雜湊函數(cryptographic hash functions)-雜湊(hashing)
    - 原理：h = H(x)，x是Arbitrary Length Text，h是Hash Value。H(x)是不會碰撞的。
        - MD5：128位元，過時不安全。由Ron Rivest開發。
        - SHA-1：160位元，過時不安全。由美國National Security Agency (NSA)開發，1995年。
        - SHA-2：224 ~ 512位元，但SHA-224 (224 bit)不建議用，可用SHA-256、SHA-384、SHA-512，由美國NSA開發。
        - SHA-3：224 ~ 512位元，包括SHA3-224、SHA3-256、SHA3-384、SHA3-512，由NIST導入，目的是取代SHA-2，屬於次世代演算法(next-generation algorithms)。
    - 特性：一次性，容易計算但不易回復。輸入是不定長度的，輸出是固定字串長度，稱為hash value / message digest / digest / digital fingerprint。
        - 弱點：若有中間人攻擊，訊息可能被掉包內容並重算雜湊值。故需要額外機制確認，如來源驗證。
    - 應用：比對檔案版次，檢查資料完整性，當作實體認證，數據真實性目的。訊息和hash會以純文字(in plaintext)同時傳送。

- 來源驗證
    - 原理：在雜湊函數執行前，對資料加入私鑰，計算出雜湊訊息鑑別碼(keyed-hash message authentication code, authenticated fingerprint, HMAC)。收發兩方共享這個私鑰，並使用指定HMAC計算及驗證。
    - 特性：收發兩方共享私鑰。
    - 其他類似：Message Authentication Code (MAC)
    - 應用：避免被中間人攻擊，目前被廣泛應用在SSL、IPsec、SSH。

- 數位簽章(digital signature)
    - 原理：非對稱加密，使用演算法Digital Signature Standard (DSS) algorithms主要有以下三種。
        - Digital Signature Algorithm (DSA)
        - Rivest-Shamir Adelman Algorithm (RSA)
        - Elliptic Curve Digital Signature Algorithm (ECDSA)：DSA的變體。
        - 另，RSE Security Inc.發行15種public-key cryptography standards (PKCS)，早期非業界標準，但已被IETF、PKIX等組織認可。
    - 特性：驗證的(autentic)、不可修改的(unalterable)、不可移轉重複使用(not resuable)、無法否認的(non-repudiated)
    - 應用：實現資實體驗證、交易不可否認性。
        1. Code signing：證明從供應商下載的執行程式完整性。
            - 查詢方式：檔案 > 內容屬性(File Property) > 詳細(Details) > View Certificate > General tab 或 Certification Path tab
        2. Digital certificates：類似虛擬ID、電子護照，驗證供應商網站的連線、傳送者來源。
            - 原理：憑證有領收者(Issued to)、核發者(Certificate Authority, CA)、到期日(Expiry date)。
            - 實作： 向第三方團體取得憑證，為網域安裝SSL憑證，讓客戶以HTTPS連線時瀏覽器可檢驗該網站的安全性。客戶連線透過CA驗證PKI後，這個憑證會存入接收者的網頁瀏覽器，憑證帶有傳送者的公鑰，這個公鑰可用來比對計算加密結果，兩者是否一致、沒被更改。

- 公鑰管理
    - CA (certificate authority)是憑證核發者，包括IdenTrust, DigiCert, Sectigo, GlobalSign, GoDaddy, Let’s Encrypt。憑證核發者會連線到憑證DB。
    - RA (registration authority)是CA的下屬，也能核發憑證。
    - public key infrastructure (PKI)包括規格、系統、工具，用於建立、維護、分發、使用、儲存、撤銷數位憑證。促進互信關係。
    
    - todo 21.4.3 The PKI Authorities System

> 常用字彙集

| 華語 | ENG |
| --- | --- |
| 協調運作 | interoperate |
| 撤銷數位憑證 | revoke digital certificates |
| 保護數位身分免遭駭客攻擊 | safeguard digital identities from hacking |
| 一個錯縱複雜的系統 | an intricate system |
| 可靠的憑證核發者 | reliable CA |
| 實體憑證 | physical certificates |
| 提供憑證的用途、憑證頒發給誰以及憑證頒發者 | provides the purposes of the certificate, who the certificate was issued to, and who issued / authorized the certificate |
| 插入惡意程式碼到檔案 | insert malicious code into the file |
| 竄改原碼 | tampered with the code |
| 提供軟體原碼驗證和完整地確認 | provide assurance of the authenticity and integrity of software code |
| PKCS不是業界標準。| PKCS are not industry standards |
| 執行檔案 | executable files |
| 被轉移到另一個檔案 | be transferred to another document |
| 作為數據交換確實發生的法律證明 | serves as legal proof that the data exchange did take place |
| 防止故意改變 | guard against deliberate changes |
| 該訊息不再可信 | the message can no longer be trusted |
| 在傳送期間 | during transit |
| 無碰撞 | collision free |
| 從數學上講，該方程式...用於解釋雜湊演算法如何運行。 | Mathematically, the equation ... is used to explain how a hash algorithm operates. |
| 數據真實性目的 | data authenticity purposes |
| 防止意外或故意更改數據，或意外損壞數據 | guard against an accidental or intentional change to the data, or accidental data corruption |
| 每當... | Every time ... |
| 兩組不同的數據不可能得到相同的雜湊輸出 | it is computationally infeasible for two different sets of data to come up with the same hash output |
| 磨碎咖啡豆 | grind coffee beans |
| 容易計算但不易回復 | is relatively easy to compute, but significantly harder to reverse |
| 不易回復 | is hard to invert |
| 事實上，趨勢是所有通訊都加密。 | In fact, the trend is toward all communication being encrypted. |
| 否認或駁斥所發送訊息的有效性 | repudiate , or refute, the validity of a message sent |
| 在合理的時間內被解密 | deciphered within a reasonable amount of time |
| 訊息被攔截 | the message is intercepted |
| MD5本質上是不安全的，並且會產生漏洞 | MD5 is inherently insecure and creates vulnerabilities |
| 偵測資料異動 | detect changes |
| 維吉尼亞密碼 | vigenère cipher |
| 凱撒密碼 | Caesar cipher |
| 密碼棒 | scytale |
| 加密訊息，編碼訊息 | encrypt messages, encode messages |
| 確保資料在連結間傳輸的安全 | secure data as it travels across links |